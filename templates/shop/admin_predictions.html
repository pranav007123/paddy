{% extends 'base.html' %}
{% load static %}

{% block title %}Diagnostic Insights - Agricultural Intelligence{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="row mb-5 align-items-center">
        <div class="col-12">
            <span class="section-tag">Machine Intelligence</span>
            <h2 class="section-title mb-0"><i class="fas fa-microscope me-2 text-primary"></i>Disease Classification
                Registry</h2>
        </div>
    </div>

    <div class="row">
        <div class="col-12">
            <div class="feature-card p-0 overflow-hidden">
                <div class="p-4 border-bottom bg-light d-flex justify-content-between align-items-center">
                    <h5 class="font-weight-bold mb-0">Diagnostic Ledger ({{ uploads|length }})</h5>
                    <div class="small text-muted">Historical inference data</div>
                </div>
                <div class="table-responsive">
                    <table class="table table-hover align-middle mb-0">
                        <thead class="bg-light small">
                            <tr>
                                <th class="ps-4">Request Ref</th>
                                <th>Subject Profile</th>
                                <th>Visual Evidence</th>
                                <th>Inference Classification</th>
                                <th class="pe-4 text-end">Processing Status</th>
                            </tr>
                        </thead>
                        <tbody class="small">
                            {% for item in uploads %}
                            <tr>
                                <td class="ps-4">
                                    <span class="font-weight-bold text-primary">#{{ item.id }}</span>
                                </td>
                                <td>
                                    <div class="font-weight-bold text-dark">{{ item.user_name }}</div>
                                    <div class="text-muted small">{{ item.user_email }}</div>
                                </td>
                                <td>
                                    {% if item.file %}
                                    <a href="/media/{{ item.file }}" target="_blank"
                                        class="d-inline-block p-1 border rounded shadow-sm">
                                        <img src="/media/{{ item.file }}" alt="leaf"
                                            style="height: 48px; width: 48px; object-fit: cover; border-radius: 4px;">
                                    </a>
                                    {% else %}
                                    <span class="text-muted small">No evidence</span>
                                    {% endif %}
                                </td>
                                <td>
                                    <span class="badge bg-light text-primary border px-3 py-2"
                                        style="font-size: 0.75rem; font-weight: 600;">
                                        {{ item.result|default:"UNDEFINED"|upper }}
                                    </span>
                                </td>
                                <td class="pe-4 text-end">
                                    <span class="badge rounded-pill bg-emerald text-white px-3 py-1"
                                        style="font-size: 0.65rem;">
                                        PROCESSED
                                    </span>
                                </td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="5" class="p-5 text-center text-muted">
                                    <i class="fas fa-clipboard-list fa-3x mb-3 opacity-25"></i>
                                    <p class="mb-0">No diagnostic inferences recorded in the system.</p>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .bg-emerald {
        background-color: var(--primary) !important;
    }
</style>
{% endblock %}